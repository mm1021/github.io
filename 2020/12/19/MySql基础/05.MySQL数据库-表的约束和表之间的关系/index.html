<!DOCTYPE html><html lang="zh_CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="MySql基础/05.MySQL数据库-表的约束和表之间的关系"><meta name="keywords" content=""><meta name="author" content="DuanChaojie,undefined"><meta name="copyright" content="DuanChaojie"><title>MySql基础/05.MySQL数据库-表的约束和表之间的关系【it❤ld】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/images/itbui.ico"><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  gitment: ,
  valine: ,
}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="it❤ld" type="application/atom+xml">
</head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库表的约束和表之间的关系"><span class="toc-text">数据库表的约束和表之间的关系</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-数据库表的约束"><span class="toc-text">1. 数据库表的约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-主键约束"><span class="toc-text">1.1 主键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-创建主键"><span class="toc-text">1.1.1 创建主键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-删除主键"><span class="toc-text">1.1.2 删除主键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-3-主键自增"><span class="toc-text">1.1.3 主键自增</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-3-1-修改自增长的默认值起始值"><span class="toc-text">1.1.3.1 修改自增长的默认值起始值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-3-2-delete-和-truncate对自增长的影响"><span class="toc-text">1.1.3.2 delete 和 truncate对自增长的影响</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-唯一约束"><span class="toc-text">1.2 唯一约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-非空约束"><span class="toc-text">1.3 非空约束</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-非空约束默认值"><span class="toc-text">1.2.1 非空约束默认值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-外键约束"><span class="toc-text">1.4 外键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-1-单表的缺点"><span class="toc-text">1.4.1 单表的缺点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-2-解决方案"><span class="toc-text">1.4.2 解决方案</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-3-外键约束"><span class="toc-text">1.4.3 外键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-4-3-1-创建外键约束"><span class="toc-text">1.4.3.1 创建外键约束</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-4-3-2-删除外键"><span class="toc-text">1.4.3.2 删除外键</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-4-3-3-外键的级联"><span class="toc-text">1.4.3.3 外键的级联</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-数据约束小结"><span class="toc-text">1.5 数据约束小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-表与表之间的关系"><span class="toc-text">2. 表与表之间的关系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-一对多"><span class="toc-text">2.1 一对多</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-多对多"><span class="toc-text">2.2 多对多</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-一对一"><span class="toc-text">2.3 一对一</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/images/qad.jpg"></div><div class="author-info-name">DuanChaojie</div><div class="author-info-description">DuanChaojie的个人博客</div><div class="links-buttons"><a class="links-button button-hover" href="https://www.itbuild.cn" target="_blank">QQ: 1585636331<i class="icon-dot bg-color0"></i></a><a class="links-button button-hover" href="https://www.itbuild.cn" target="_blank">手机：17351015389<i class="icon-dot bg-color7"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">星星</span><span class="pull-bottom">118</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">10</span></a></div><div class="friend-link"><a class="friend-link-text" href="http://www.cyc2018.xyz/" target="_blank">算法训练</a><a class="friend-link-text" href="https://www.bilibili.com/" target="_blank">相约B站</a><a class="friend-link-text" href="https://account.aliyun.com/" target="_blank">图床地址</a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="title-name" href="/">it❤ld</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">MySql基础/05.MySQL数据库-表的约束和表之间的关系</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2020-12-19 | 更新于 2020-12-19</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/MySql%E5%9F%BA%E7%A1%80/">MySql基础</a></div><div class="button-hover tags"></div></div></div><div class="main-content"><p>往事悠悠君莫问，回头。槛外长江空自流。</p>
<p align="right">——王安石《南乡子》</p>
<a id="more"></a>



<h1 id="数据库表的约束和表之间的关系"><a href="#数据库表的约束和表之间的关系" class="headerlink" title="数据库表的约束和表之间的关系"></a>数据库表的约束和表之间的关系</h1><h2 id="1-数据库表的约束"><a href="#1-数据库表的约束" class="headerlink" title="1. 数据库表的约束"></a>1. 数据库表的约束</h2><blockquote>
<p>约束的作用：</p>
<ul>
<li><p>对表中的数据进行限制，保证数据的正确性、有效性和完整性。</p>
</li>
<li><p>一个表如果添加了约束，不正确的数据将无法插入到表中。</p>
</li>
<li><p><strong>约束在创建表的时候添加比较合适</strong>。</p>
</li>
</ul>
</blockquote>
<p><strong>约束的种类</strong></p>
<table>
<thead>
<tr>
<th>约束名</th>
<th>约束关键字</th>
</tr>
</thead>
<tbody><tr>
<td>主键</td>
<td>primary key</td>
</tr>
<tr>
<td>唯一</td>
<td>unique</td>
</tr>
<tr>
<td>非空</td>
<td>not null</td>
</tr>
<tr>
<td>外键</td>
<td>foreign key</td>
</tr>
<tr>
<td>检查约束</td>
<td>check       注：mysql 不支持</td>
</tr>
</tbody></table>
<h3 id="1-1-主键约束"><a href="#1-1-主键约束" class="headerlink" title="1.1 主键约束"></a>1.1 主键约束</h3><blockquote>
<p>用来唯一标识数据库中的每一条记录</p>
<p>哪个字段应该作为表的主键？</p>
<p>通常<strong>不用业务字段</strong>作为主键，单独给每张表设计一个 id 的字段，把 id 作为主键。主键是给数据库和程序使用的，不是给最终的客户使用的。所以主键有没有含义没有关系，只要不重复，非空就行。<br>  如：身份证，学号不建议做成主键</p>
</blockquote>
<h4 id="1-1-1-创建主键"><a href="#1-1-1-创建主键" class="headerlink" title="1.1.1 创建主键"></a>1.1.1 创建主键</h4><blockquote>
<p>创建主键关键字： primary key<br>主键的特点：</p>
<ul>
<li>非空 not null</li>
<li>唯一 unique</li>
</ul>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建主键的两种方式</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1.在创建表的时候给字段添加主键</span></span><br><span class="line">字段名 字段类型 primary key</span><br><span class="line"><span class="comment">-- 2.在已有表中添加主键</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> primary <span class="keyword">key</span>(字段名);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 演示</span></span><br><span class="line">创建表学生表 student, 包含字段(id, name, age)将 id做为主键</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span>, <span class="comment">-- id为主键</span></span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">age <span class="built_in">int</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">desc</span> student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入重复的主键值</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">'上官婉儿'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="comment">-- 错误代码：1062 Duplicate entry '1' for key'PRIMARY'</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">'上官'</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入 null的主键值, Column 'id' cannot be null</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> st5 <span class="keyword">values</span> (<span class="literal">null</span>, <span class="string">'上官婉儿'</span>, <span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<h4 id="1-1-2-删除主键"><a href="#1-1-2-删除主键" class="headerlink" title="1.1.2 删除主键"></a>1.1.2 删除主键</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除student表的主键</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> primary <span class="keyword">key</span>;</span><br><span class="line"><span class="comment">-- 添加主键</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> primary <span class="keyword">key</span>(<span class="keyword">id</span>);</span><br></pre></td></tr></table></figure>

<h4 id="1-1-3-主键自增"><a href="#1-1-3-主键自增" class="headerlink" title="1.1.3 主键自增"></a>1.1.3 主键自增</h4><blockquote>
<p>主键如果让我们自己添加很有可能重复,我们通常希望在每次插入新记录时,数据库自动生成主键字段的值</p>
<p><strong>auto_increment表示自动增长(字段类型必须是整数类型)</strong></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">创建表学生表 student, 包含字段(id, name, age)将 id做为主键</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment, <span class="comment">-- id为主键</span></span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">age <span class="built_in">int</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"> <span class="comment">-- 插入数据</span></span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> student (<span class="keyword">name</span>,age) <span class="keyword">values</span> (<span class="string">'小乔'</span>,<span class="number">18</span>);</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> student (<span class="keyword">name</span>,age) <span class="keyword">values</span> (<span class="string">'大乔'</span>,<span class="number">20</span>);</span><br><span class="line"> <span class="comment">-- 另一种写法</span></span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'周瑜'</span>,<span class="number">35</span>);</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">select</span> * <span class="keyword">from</span> student;</span><br></pre></td></tr></table></figure>

<h5 id="1-1-3-1-修改自增长的默认值起始值"><a href="#1-1-3-1-修改自增长的默认值起始值" class="headerlink" title="1.1.3.1 修改自增长的默认值起始值"></a>1.1.3.1 修改自增长的默认值起始值</h5><blockquote>
<p> 默认地 AUTO_INCREMENT 的开始值是 1，如果希望修改起始值,请使用下列 SQL 语法</p>
</blockquote>
<p><strong>创建表的时候修改自增长起始值</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名 (</span><br><span class="line">列名 <span class="built_in">int</span> primary auto_increment</span><br><span class="line">)auto_increment=起始值; <span class="comment">-- 修改自增长的默认值起始值</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">-- 指定起始值为 1000</span></span><br><span class="line"> <span class="keyword">create</span> <span class="keyword">table</span> student (</span><br><span class="line"> <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line"> <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>)</span><br><span class="line"> ) auto_increment = <span class="number">1000</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> st4 <span class="keyword">values</span> (<span class="literal">null</span>, <span class="string">'孔明'</span>);</span><br></pre></td></tr></table></figure>

<p><strong>创建好表以后修改起始值</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 auto_increment=起始值;</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student auto_increment = <span class="number">2000</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span> (<span class="literal">null</span>, <span class="string">'刘备'</span>);</span><br></pre></td></tr></table></figure>

<h5 id="1-1-3-2-delete-和-truncate对自增长的影响"><a href="#1-1-3-2-delete-和-truncate对自增长的影响" class="headerlink" title="1.1.3.2 delete 和 truncate对自增长的影响"></a>1.1.3.2 delete 和 truncate对自增长的影响</h5><ul>
<li>delete 删除所有的记录之后，自增长没有影响。</li>
<li>truncate 删除以后，自增长又重新开始。</li>
</ul>
<h3 id="1-2-唯一约束"><a href="#1-2-唯一约束" class="headerlink" title="1.2 唯一约束"></a>1.2 唯一约束</h3><blockquote>
<p>什么是唯一约束？</p>
<p>就是表中某一列不能出现重复的值。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 唯一约束的基本语法格式</span></span><br><span class="line">字段名 字段类型 unique;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建学生表 student, 包含字段(id, name),name这一列设置唯一约束,不能出现同名的学生</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">unique</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加一个同名的学生</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">'张三'</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Duplicate entry '张三' for key 'name'</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span> (<span class="number">2</span>, <span class="string">'张三'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 重复插入多个 null会怎样？</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span> (<span class="number">2</span>, <span class="literal">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span> (<span class="number">3</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- null没有数据，不存在重复的问题</span></span><br><span class="line"><span class="comment">-- null没有数据，不存在重复的问题</span></span><br><span class="line"><span class="comment">-- null没有数据，不存在重复的问题</span></span><br></pre></td></tr></table></figure>





<h3 id="1-3-非空约束"><a href="#1-3-非空约束" class="headerlink" title="1.3 非空约束"></a>1.3 非空约束</h3><blockquote>
<p>什么是非空约束？</p>
<p>就是某一列不能为 null。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 非空约束的基本语法格式</span></span><br><span class="line">字段名 字段类型 not null;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建表学生表 student, 包含字段(id,name,gender)其中 name不能为 null</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">gender <span class="built_in">char</span>(<span class="number">1</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加一条记录其中姓名不赋值</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">'张三疯'</span>,<span class="string">'男'</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Column 'name' cannot be null</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span> (<span class="number">2</span>,<span class="literal">null</span>,<span class="string">'男'</span>);</span><br></pre></td></tr></table></figure>

<h4 id="1-2-1-非空约束默认值"><a href="#1-2-1-非空约束默认值" class="headerlink" title="1.2.1 非空约束默认值"></a>1.2.1 非空约束默认值</h4><blockquote>
<p>什么是非空约束默认值？</p>
<p><strong>字段名 字段类型 default 默认值;</strong></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个学生表 student4，包含字段(id,name,address)，地址默认值是广州</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">address <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">default</span> <span class="string">'广州'</span></span><br><span class="line">)</span><br><span class="line">  </span><br><span class="line"><span class="comment">-- 添加一条记录,使用默认地址</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">'李四'</span>, <span class="keyword">default</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student (<span class="keyword">id</span>,<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="number">2</span>, <span class="string">'李白'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加一条记录,不使用默认地址</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span> (<span class="number">3</span>, <span class="string">'李四光'</span>, <span class="string">'深圳'</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>如果一个字段设置了非空与唯一约束，该字段与主键的区别?</strong></p>
</blockquote>
<ul>
<li>主键数在一个表中，只能有一个。不能出现多个主键。主键可以单列，也可以是多列。</li>
<li>自增长只能用在主键上</li>
</ul>
<h3 id="1-4-外键约束"><a href="#1-4-外键约束" class="headerlink" title="1.4 外键约束"></a>1.4 外键约束</h3><h4 id="1-4-1-单表的缺点"><a href="#1-4-1-单表的缺点" class="headerlink" title="1.4.1 单表的缺点"></a>1.4.1 单表的缺点</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个员工表包含如下列(id, name, age, dep_name, dep_location),id 主键并自动增长,添加 6 条数据</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">30</span>),</span><br><span class="line">    age <span class="built_in">int</span>,</span><br><span class="line">    dep_name <span class="built_in">varchar</span>(<span class="number">30</span>),</span><br><span class="line">    dep_location <span class="built_in">varchar</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (<span class="keyword">name</span>, age, dep_name, dep_location) <span class="keyword">values</span> (<span class="string">'张三'</span>, <span class="number">20</span>, <span class="string">'研发部'</span>, <span class="string">'广州'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (<span class="keyword">name</span>, age, dep_name, dep_location) <span class="keyword">values</span> (<span class="string">'李四'</span>, <span class="number">21</span>, <span class="string">'研发部'</span>, <span class="string">'广州'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (<span class="keyword">name</span>, age, dep_name, dep_location) <span class="keyword">values</span> (<span class="string">'王五'</span>, <span class="number">20</span>, <span class="string">'研发部'</span>, <span class="string">'广州'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (<span class="keyword">name</span>, age, dep_name, dep_location) <span class="keyword">values</span> (<span class="string">'老王'</span>, <span class="number">20</span>, <span class="string">'销售部'</span>, <span class="string">'深圳'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (<span class="keyword">name</span>, age, dep_name, dep_location) <span class="keyword">values</span> (<span class="string">'大王'</span>, <span class="number">22</span>, <span class="string">'销售部'</span>, <span class="string">'深圳'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (<span class="keyword">name</span>, age, dep_name, dep_location) <span class="keyword">values</span> (<span class="string">'小王'</span>, <span class="number">18</span>, <span class="string">'销售部'</span>, <span class="string">'深圳'</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>以上数据表的缺点:</p>
<ul>
<li><strong>数据冗余</strong></li>
<li><strong>后期还会出现增删改的问题</strong></li>
</ul>
</blockquote>
<h4 id="1-4-2-解决方案"><a href="#1-4-2-解决方案" class="headerlink" title="1.4.2 解决方案"></a>1.4.2 解决方案</h4><blockquote>
<p>分成 2 张表，设置<strong>主表和从表</strong>。</p>
</blockquote>
<p><img src="C:%5CUsers%5CAdministrator%5CDesktop%5C%E7%AC%94%E8%AE%B0%5C%E6%95%B0%E6%8D%AE%E5%BA%93-justweb%5Cday02%5Cassets%5C1565536840044.png" alt=""></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建部门表(id,dep_name,dep_location)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 一方，主表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> department(</span><br><span class="line">      <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">      dep_name <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">      dep_location <span class="built_in">varchar</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line">  </span><br><span class="line"><span class="comment">-- 创建员工表(id,name,age,dep_id)</span></span><br><span class="line"><span class="comment">-- 多方，从表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> employee(</span><br><span class="line">      <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">      <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">      age <span class="built_in">int</span>,</span><br><span class="line">      dep_id <span class="built_in">int</span> <span class="comment">-- 外键对应主表的主键</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加 2 个部门</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> department <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'研发部'</span>,<span class="string">'广州'</span>),(<span class="literal">null</span>, <span class="string">'销售部'</span>, <span class="string">'深圳'</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> department;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加员工,dep_id表示员工所在的部门</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'张三'</span>, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'李四'</span>, <span class="number">21</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'王五'</span>, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'老王'</span>, <span class="number">20</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'大王'</span>, <span class="number">22</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'小王'</span>, <span class="number">18</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> employee;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>当我们在 employee 的 dep_id 里面输入不存在的部门,数据依然可以添加.但是并没有对应的部门，实际应用中不能出现这种情况。</strong></p>
<p>employee 的 dep_id 中的数据只能是 department 表中存在的 id</p>
</blockquote>
<h4 id="1-4-3-外键约束"><a href="#1-4-3-外键约束" class="headerlink" title="1.4.3 外键约束"></a>1.4.3 外键约束</h4><blockquote>
<p>什么是外键？</p>
<p>在从表中与主表主键对应的那一列，如：员工表中dep_id</p>
<p>==主表==： <strong>一方，用来约束别人的表</strong><br>==从表==： <strong>多方，被别人约束的表</strong></p>
</blockquote>
<p><img src="C:%5CUsers%5CAdministrator%5CDesktop%5C%E7%AC%94%E8%AE%B0%5C%E6%95%B0%E6%8D%AE%E5%BA%93-justweb%5Cday02%5Chttps://oss-blogs.oss-cn-hangzhou.aliyuncs.com/blogs/itbuild/MySql%E5%9F%BA%E7%A1%80/1565537014339.png" alt=""></p>
<h5 id="1-4-3-1-创建外键约束"><a href="#1-4-3-1-创建外键约束" class="headerlink" title="1.4.3.1 创建外键约束"></a>1.4.3.1 创建外键约束</h5><blockquote>
<p><strong>新建表时增加外键</strong></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[constraint] [外键约束名称] foreign key (外键字段名) references 主表名(主键字段名);</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>已有表增加外键</strong></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 从表 <span class="keyword">add</span> [<span class="keyword">constraint</span>] [外键约束名称] <span class="keyword">foreign</span> <span class="keyword">key</span> (外键字段名) <span class="keyword">references</span> 主表(主键字段名);</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1.删除副表/从表 employee</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> employee;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.创建从表 employee 并添加外键约束 emp_depid_fk</span></span><br><span class="line"><span class="comment">-- 多方，从表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> employee(</span><br><span class="line">      <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">      <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">      age <span class="built_in">int</span>,</span><br><span class="line">      dep_id <span class="built_in">int</span>, <span class="comment">-- 外键对应主表的主键</span></span><br><span class="line">      <span class="keyword">constraint</span> emp_depid_fk <span class="keyword">foreign</span> <span class="keyword">key</span> (dep_id) <span class="keyword">references</span> department(<span class="keyword">id</span>)  <span class="comment">-- 创建外键约束</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">-- 3.正常添加数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'张三'</span>, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'李四'</span>, <span class="number">21</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'王五'</span>, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'老王'</span>, <span class="number">20</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'大王'</span>, <span class="number">22</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'小王'</span>, <span class="number">18</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> employee;</span><br><span class="line">  </span><br><span class="line"><span class="comment">-- 4.部门错误的数据添加失败</span></span><br><span class="line"><span class="comment">-- 插入不存在的部门</span></span><br><span class="line"><span class="comment">-- Cannot add or update a child row: a foreign key constraint fails</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'老张'</span>, <span class="number">18</span>, <span class="number">6</span>);</span><br></pre></td></tr></table></figure>



<p><img src="C:%5CUsers%5CAdministrator%5CDesktop%5C%E7%AC%94%E8%AE%B0%5C%E6%95%B0%E6%8D%AE%E5%BA%93-justweb%5Cday02%5Cassets%5C1565537125036.png" alt=""></p>
<h5 id="1-4-3-2-删除外键"><a href="#1-4-3-2-删除外键" class="headerlink" title="1.4.3.2 删除外键"></a>1.4.3.2 删除外键</h5><blockquote>
<p><strong>alter table 从表 drop foreign key 外键名称;</strong></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除 employee表的 emp_depid_fk外键</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> employee <span class="keyword">drop</span> <span class="keyword">foreign</span> <span class="keyword">key</span> emp_depid_fk;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在 employee表存在的情况下添加外键</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> employee <span class="keyword">add</span> <span class="keyword">constraint</span> emp_depid_fk</span><br><span class="line"><span class="keyword">foreign</span> <span class="keyword">key</span> (dep_id) <span class="keyword">references</span> department(<span class="keyword">id</span>);</span><br></pre></td></tr></table></figure>



<h5 id="1-4-3-3-外键的级联"><a href="#1-4-3-3-外键的级联" class="headerlink" title="1.4.3.3 外键的级联"></a>1.4.3.3 外键的级联</h5><blockquote>
<p>什么是级联操作？</p>
<p>在修改和删除主表的主键时，同时更新或删除副表的外键值，称为级联操作</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 出现新的问题</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> employee;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> department;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">要把部门表中的 id值 2，改成 5，能不能直接更新呢？会报出一下错误：</span></span><br><span class="line"><span class="comment">Cannot delete or update a parent row: a foreign key constraint fails</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">update</span> department <span class="keyword">set</span> <span class="keyword">id</span>=<span class="number">5</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">要删除部门 id等于 1的部门, 能不能直接删除呢？会报出一下错误：</span></span><br><span class="line"><span class="comment">Cannot delete or update a parent row: a foreign key constraint fails</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> department <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<table>
<thead>
<tr>
<th align="left">级联操作语法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>on update cascade</strong></td>
<td align="left">级联更新，只能是创建表的时候创建级联关系,<br/>更新主表中的主键，从表中的外键列也自动同步更新</td>
</tr>
<tr>
<td align="left"><strong>on delete cascade</strong></td>
<td align="left">级联删除</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除 employee表，重新创建 employee表，添加级联更新和级联删除</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> employee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> employee(</span><br><span class="line">      <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">      <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">      age <span class="built_in">int</span>,</span><br><span class="line">      dep_id <span class="built_in">int</span>, <span class="comment">-- 外键对应主表的主键</span></span><br><span class="line">      <span class="keyword">constraint</span> emp_depid_fk <span class="keyword">foreign</span> <span class="keyword">key</span> (dep_id) <span class="keyword">references</span> department(<span class="keyword">id</span>) <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">cascade</span> <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">cascade</span>   <span class="comment">-- 创建外键约束</span></span><br><span class="line">  )</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">-- 再次添加数据到员工表和部门表</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'张三'</span>, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'李四'</span>, <span class="number">21</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'王五'</span>, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'老王'</span>, <span class="number">20</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'大王'</span>, <span class="number">22</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> employee (<span class="keyword">name</span>, age, dep_id) <span class="keyword">values</span> (<span class="string">'小王'</span>, <span class="number">18</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除部门表？能不能直接删除？</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> department;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 把部门表中 id等于 1的部门改成 id等于 10</span></span><br><span class="line"><span class="keyword">update</span> department <span class="keyword">set</span> <span class="keyword">id</span>=<span class="number">10</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> employee;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> department;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除部门号是 2的部门</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> department <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<h3 id="1-5-数据约束小结"><a href="#1-5-数据约束小结" class="headerlink" title="1.5 数据约束小结"></a>1.5 数据约束小结</h3><table>
<thead>
<tr>
<th>约束名</th>
<th>关键字</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>主键</td>
<td>primary key</td>
<td>唯一,非空</td>
</tr>
<tr>
<td>默认</td>
<td>default</td>
<td>如果一列没有值，使用默认值</td>
</tr>
<tr>
<td>非空</td>
<td>not null</td>
<td>这一列必须有值</td>
</tr>
<tr>
<td>唯一</td>
<td>unique</td>
<td>这一列不能有重复值</td>
</tr>
<tr>
<td>外键</td>
<td>foreign key</td>
<td>主表中主键列，在从表中外键列</td>
</tr>
</tbody></table>
<h2 id="2-表与表之间的关系"><a href="#2-表与表之间的关系" class="headerlink" title="2. 表与表之间的关系"></a>2. 表与表之间的关系</h2><blockquote>
<p> 概念：</p>
<ul>
<li>现实生活中，实体与实体之间肯定是有关系的，比如：爸爸和儿子，部门和员工，老师(喵喵)和学生(dd)等。那么我们在设计表的时候，就应该体现出表与表之间的这种关系！</li>
</ul>
</blockquote>
<table>
<thead>
<tr>
<th>表与表之间的三种关系</th>
<th>关系的维护</th>
</tr>
</thead>
<tbody><tr>
<td>一对多：最常用的关系 部门和员工</td>
<td>主外键的关系</td>
</tr>
<tr>
<td>多对多：学生选课表 和 学生表， 一门课程可以有多个学生选择，一个学生选择多门课程</td>
<td>中间表，两个一对多</td>
</tr>
<tr>
<td>一对一：相对使用比较少。员工表 简历表， 公民表 护照表</td>
<td>特殊一对多，从表中的外键设置为唯一,从表中的主键又是外键</td>
</tr>
</tbody></table>
<h3 id="2-1-一对多"><a href="#2-1-一对多" class="headerlink" title="2.1 一对多"></a>2.1 一对多</h3><blockquote>
<p>一对多（1 : n） </p>
<p>例如：班级和学生，部门和员工，客户和订单，分类和商品</p>
</blockquote>
<p>*<em>一对多建表原则: *</em></p>
<p>​        在从表(多方)创建一个字段,字段作为外键指向主表(一方)的主键</p>
<h3 id="2-2-多对多"><a href="#2-2-多对多" class="headerlink" title="2.2 多对多"></a>2.2 多对多</h3><blockquote>
<p> 多对多（m : n） </p>
<p>例如：老师和学生，学生和课程，用户和角色</p>
</blockquote>
<p><strong>多对多关系建表原则:</strong> </p>
<p>​        需要创建第三张表，中间表中至少两个字段，这两个字段分别作为外键指向各自一方的主键。</p>
<p><img src="C:%5CUsers%5CAdministrator%5CDesktop%5C%E7%AC%94%E8%AE%B0%5C%E6%95%B0%E6%8D%AE%E5%BA%93-justweb%5Cday02%5Cassets%5C1565537785287.png" alt=""></p>
<h3 id="2-3-一对一"><a href="#2-3-一对一" class="headerlink" title="2.3 一对一"></a>2.3 一对一</h3><blockquote>
<p>  一对一（1: 1） </p>
<p>在实际的开发中应用不多.因为一对一可以创建成一张表。</p>
</blockquote>
<p>两种建表原则：</p>
<table>
<thead>
<tr>
<th>一对一的建表原则</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>外键唯一</td>
<td>主表的主键和从表的外键（唯一），形成主外键关系，外键唯一 unique</td>
</tr>
<tr>
<td>外键是主键</td>
<td>主表的主键和从表的主键，形成主外键关系</td>
</tr>
</tbody></table>
<p><img src="C:%5CUsers%5CAdministrator%5CDesktop%5C%E7%AC%94%E8%AE%B0%5C%E6%95%B0%E6%8D%AE%E5%BA%93-justweb%5Cday02%5Cassets%5C1565538017057.png" alt=""></p>
</div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">DuanChaojie</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="http://www.itbuild.cn/2020/12/19/MySql%E5%9F%BA%E7%A1%80/05.MySQL%E6%95%B0%E6%8D%AE%E5%BA%93-%E8%A1%A8%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%92%8C%E8%A1%A8%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB/">http://www.itbuild.cn/2020/12/19/MySql%E5%9F%BA%E7%A1%80/05.MySQL%E6%95%B0%E6%8D%AE%E5%BA%93-%E8%A1%A8%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%92%8C%E8%A1%A8%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB/</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.itbuild.cn">it❤ld</a>！</span></div></div></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2020/12/19/MySql%E5%9F%BA%E7%A1%80/06.MySQL%E6%95%B0%E6%8D%AE%E5%BA%93-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E5%92%8C%E5%AD%90%E6%9F%A5%E8%AF%A2/"><i class="fas fa-angle-left">&nbsp;</i><span>MySql基础/06.MySQL数据库-多表查询和子查询</span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2020/12/19/MySql%E5%9F%BA%E7%A1%80/04.DQL%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5-%E6%8E%92%E5%BA%8F%E5%92%8C%E5%88%86%E7%BB%84/"><span>MySql基础/04.DQL查询语句-排序和分组</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2020 By DuanChaojie</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--></body></html>