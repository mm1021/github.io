<!DOCTYPE html><html lang="zh_CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="JavaSE-爬虫/【Java爬虫】—爬取51job网Java招聘信息"><meta name="keywords" content=""><meta name="author" content="DuanChaojie,undefined"><meta name="copyright" content="DuanChaojie"><title>JavaSE-爬虫/【Java爬虫】—爬取51job网Java招聘信息【it❤ld】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/images/itbui.ico"><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  gitment: ,
  valine: ,
}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="it❤ld" type="application/atom+xml">
</head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#爬取51job网Java招聘信息"><span class="toc-text">爬取51job网Java招聘信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-业务分析"><span class="toc-text">1. 业务分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-数据库表"><span class="toc-text">2. 数据库表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-实现流程"><span class="toc-text">3. 实现流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-Scheduler组件"><span class="toc-text">3.1 Scheduler组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-三种去重方式"><span class="toc-text">3.2 三种去重方式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#HashSet"><span class="toc-text">HashSet</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Redis去重"><span class="toc-text">Redis去重</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#布隆过滤器-使用较多"><span class="toc-text">布隆过滤器 (使用较多)</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#优缺点："><span class="toc-text">优缺点：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#简介："><span class="toc-text">简介：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#原理："><span class="toc-text">原理：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-案例实现"><span class="toc-text">4. 案例实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-开发准备"><span class="toc-text">4.1 开发准备</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#编写pojo"><span class="toc-text">编写pojo</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#编写dao"><span class="toc-text">编写dao</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#编写service"><span class="toc-text">编写service</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#JobInfoService"><span class="toc-text">JobInfoService</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#JobInfoServiceImpl"><span class="toc-text">JobInfoServiceImpl</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#编写启动类"><span class="toc-text">编写启动类</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-代码实现"><span class="toc-text">4.2 代码实现</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#工具类MathSalary"><span class="toc-text">工具类MathSalary</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#自定义Pipeline存储数据"><span class="toc-text">自定义Pipeline存储数据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#编写主要的爬虫task"><span class="toc-text">编写主要的爬虫task</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-案例扩展"><span class="toc-text">5. 案例扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-定时任务"><span class="toc-text">5.1 定时任务</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Cron表达式"><span class="toc-text">Cron表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Cron测试"><span class="toc-text">Cron测试</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-网页去重"><span class="toc-text">5.2 网页去重</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#去重方案介绍"><span class="toc-text">去重方案介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#指纹码对比"><span class="toc-text">指纹码对比</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#BloomFilter"><span class="toc-text">BloomFilter</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#KMP算法"><span class="toc-text">KMP算法</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#SimHash"><span class="toc-text">SimHash</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-代理的使用"><span class="toc-text">5.3 代理的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#代理服务器"><span class="toc-text">代理服务器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#使用代理"><span class="toc-text">使用代理</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#☆"><span class="toc-text">☆</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/images/qad.jpg"></div><div class="author-info-name">DuanChaojie</div><div class="author-info-description">DuanChaojie的个人博客</div><div class="links-buttons"><a class="links-button button-hover" href="https://www.itbuild.cn" target="_blank">QQ: 1585636331<i class="icon-dot bg-color8"></i></a><a class="links-button button-hover" href="https://www.itbuild.cn" target="_blank">手机：17351015389<i class="icon-dot bg-color4"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">星星</span><span class="pull-bottom">122</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">11</span></a></div><div class="friend-link"><a class="friend-link-text" href="http://www.cyc2018.xyz/" target="_blank">算法训练</a><a class="friend-link-text" href="https://www.bilibili.com/" target="_blank">相约B站</a><a class="friend-link-text" href="https://account.aliyun.com/" target="_blank">图床地址</a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="title-name" href="/">it❤ld</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">JavaSE-爬虫/【Java爬虫】—爬取51job网Java招聘信息</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2020-12-30 | 更新于 2020-12-30</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/JavaSE-%E7%88%AC%E8%99%AB/">JavaSE-爬虫</a></div><div class="button-hover tags"></div></div></div><div class="main-content"><p>青春都一饷。忍把浮名，换了浅斟低唱！</p>
<p align="right">——柳永《鹤冲天》</p>
<a id="more"></a>


<h1 id="爬取51job网Java招聘信息"><a href="#爬取51job网Java招聘信息" class="headerlink" title="爬取51job网Java招聘信息"></a>爬取51job网Java招聘信息</h1><p>我们已经学完了WebMagic的基本使用方法，现在准备使用WebMagic实现爬取数据的功能。这里是一个比较完整的实现。</p>
<p>在这里我们实现的是聚焦网络爬虫，只爬取招聘的相关数据。</p>
<h3 id="1-业务分析"><a href="#1-业务分析" class="headerlink" title="1. 业务分析"></a>1. 业务分析</h3><p>今天要实现的是爬取<a href="https://www.51job.com/上的招聘信息" target="_blank" rel="noopener">https://www.51job.com/上的招聘信息</a>, 只爬取与<code>“java”</code>相关和在南京地区行业的信息。</p>
<p>首先访问页面搜索”南京“+“Java”,结果如下：</p>
<p><img src="https://oss-blogs.oss-cn-hangzhou.aliyuncs.com/blogs/itbuild/JavaSE-%E7%88%AC%E8%99%AB/image-20201230102510237.png" alt="image-20201230102510237"></p>
<p>点击职位详情页，我们分析发现详情页还有一些数据需要抓取：</p>
<p>职位、公司名称、工作地点、薪资、发布时间、职位信息、公司联系方式、公司信息。</p>
<p><img src="https://oss-blogs.oss-cn-hangzhou.aliyuncs.com/blogs/itbuild/JavaSE-%E7%88%AC%E8%99%AB/success.jpg" alt="success"></p>
<h3 id="2-数据库表"><a href="#2-数据库表" class="headerlink" title="2. 数据库表"></a>2. 数据库表</h3><p>根据以上信息，设计数据库表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`job_info`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'主键id'</span>,</span><br><span class="line">  <span class="string">`company_name`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'公司名称'</span>,</span><br><span class="line">  <span class="string">`company_addr`</span> <span class="built_in">varchar</span>(<span class="number">200</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'公司联系方式'</span>,</span><br><span class="line">  <span class="string">`company_info`</span> <span class="built_in">text</span> <span class="keyword">COMMENT</span> <span class="string">'公司信息'</span>,</span><br><span class="line">  <span class="string">`job_name`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'职位名称'</span>,</span><br><span class="line">  <span class="string">`job_addr`</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'工作地点'</span>,</span><br><span class="line">  <span class="string">`job_info`</span> <span class="built_in">text</span> <span class="keyword">COMMENT</span> <span class="string">'职位信息'</span>,</span><br><span class="line">  <span class="string">`salary_min`</span> <span class="built_in">int</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'薪资范围，最小'</span>,</span><br><span class="line">  <span class="string">`salary_max`</span> <span class="built_in">int</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'薪资范围，最大'</span>,</span><br><span class="line">  <span class="string">`url`</span> <span class="built_in">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'招聘信息详情页'</span>,</span><br><span class="line">  <span class="string">`time`</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'职位最近发布时间'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'招聘信息'</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-实现流程"><a href="#3-实现流程" class="headerlink" title="3. 实现流程"></a>3. 实现流程</h3><p>我们需要解析职位列表页，获取职位的详情页，再解析页面获取数据。获取url地址的流程如下：</p>
<p><img src="https://oss-blogs.oss-cn-hangzhou.aliyuncs.com/blogs/itbuild/JavaSE-%E7%88%AC%E8%99%AB/image-20201230105702238.png" alt="image-20201230105702238"></p>
<p>但是在这里有个问题：</p>
<p>在解析页面的时候，很可能会解析出相同的url地址(例如商品标题和商品图片超链接，而且url一样)，如果不进行处理，同样的url会解析处理多次，浪费资源。所以我们需要有一个url去重的功能。</p>
<h4 id="3-1-Scheduler组件"><a href="#3-1-Scheduler组件" class="headerlink" title="3.1 Scheduler组件"></a>3.1 Scheduler组件</h4><p>WebMagic提供了Scheduler可以帮助我们解决以上问题。</p>
<p>Scheduler是WebMagic中进行URL管理的组件。一般来说，Scheduler包括两个作用：</p>
<ul>
<li>对待抓取的URL队列进行管理。</li>
<li>对已抓取的URL进行去重。</li>
</ul>
<p>WebMagic内置了几个常用的Scheduler。如果你只是在本地执行规模比较小的爬虫，那么基本无需定制Scheduler，但是了解一下已经提供的几个Scheduler还是有意义的</p>
<table>
<thead>
<tr>
<th>类</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>DuplicateRemovedScheduler</td>
<td>抽象基类，提供一些模板方法</td>
<td>继承它可以实现自己的功能</td>
</tr>
<tr>
<td>QueueScheduler</td>
<td>使用内存队列保存待抓取URL (一般常用)</td>
<td></td>
</tr>
<tr>
<td>PriorityScheduler</td>
<td>使用带有优先级的内存队列保存待抓取URL</td>
<td>耗费内存较QueueScheduler更大，但是当设置了request.priority之后，只能使用PriorityScheduler才可使优先级生效</td>
</tr>
<tr>
<td>FileCacheQueueScheduler</td>
<td>使用文件保存抓取URL，可以在关闭程序并下次启动时，从之前抓取到的URL继续抓取(效率慢)</td>
<td>需指定路径，会建立.urls.txt和.cursor.txt两个文件</td>
</tr>
<tr>
<td>RedisScheduler</td>
<td>使用Redis保存抓取队列，可进行多台机器同时合作抓取(成本较高)</td>
<td>需要安装并启动redis</td>
</tr>
</tbody></table>
<p>去重部分被单独抽象成了一个接口：DuplicateRemover，从而可以为同一个Scheduler选择不同的去重方式，以适应不同的需要，目前提供了两种去重方式。</p>
<table>
<thead>
<tr>
<th>类</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>HashSetDuplicateRemover</td>
<td>使用HashSet来进行去重，占用内存较大 (较少时使用)</td>
</tr>
<tr>
<td>BloomFilterDuplicateRemover</td>
<td>布隆过滤器, 使用BloomFilter来进行去重，占用内存较小，但是可能漏抓页面 (比hash效率高很多, 一般用这个, 要忍受丢链接)</td>
</tr>
</tbody></table>
<p>RedisScheduler是使用Redis的set进行去重，其他的Scheduler(包括未指定的)默认都使用HashSetDuplicateRemover来进行去重</p>
<p>如果要使用BloomFilter，必须要加入以下依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--WebMagic对布隆过滤器的支持--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.guava<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>guava<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>16.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>修改代码添加布隆过滤器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itbuild.webmagic.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Page;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Site;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Spider;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.pipeline.FilePipeline;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.processor.PageProcessor;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.scheduler.BloomFilterDuplicateRemover;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.scheduler.QueueScheduler;</span><br><span class="line"></span><br><span class="line">/`</span><br><span class="line"> * <span class="meta">@Date</span> <span class="number">2020</span>/<span class="number">12</span>/<span class="number">22</span> <span class="number">21</span>:<span class="number">42</span></span><br><span class="line"> * <span class="meta">@Version</span> <span class="number">10.21</span></span><br><span class="line"> * <span class="meta">@Author</span> DuanChaojie</span><br><span class="line"> */</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JobProcessor</span> <span class="keyword">implements</span> <span class="title">PageProcessor</span> </span>&#123;</span><br><span class="line">    /`</span><br><span class="line">     * 解析页面</span><br><span class="line">     */</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(Page page)</span> </span>&#123;</span><br><span class="line">        page.addTargetRequest(<span class="string">"https://jobs.51job.com/nanjing/126611437.html?s=01&amp;t=5"</span>);</span><br><span class="line">        page.addTargetRequest(<span class="string">"https://jobs.51job.com/nanjing/126611437.html?s=01&amp;t=5"</span>);</span><br><span class="line">        page.addTargetRequest(<span class="string">"https://jobs.51job.com/nanjing/126611437.html?s=01&amp;t=5"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Site site = Site.me()</span><br><span class="line">            .setCharset(<span class="string">"utf8"</span>) <span class="comment">// 设置编码</span></span><br><span class="line">            .setTimeOut(<span class="number">1000</span>) <span class="comment">// 设置超时时间, 单位是ms毫秒</span></span><br><span class="line">            .setRetrySleepTime(<span class="number">3000</span>) <span class="comment">// 设置重试的间隔时间</span></span><br><span class="line">            .setSleepTime(<span class="number">3</span>); <span class="comment">// 设置重试次数</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Site <span class="title">getSite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> site;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /`</span><br><span class="line">     * 主函数, 执行爬虫</span><br><span class="line">     */</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Spider.create(<span class="keyword">new</span> JobProcessor())</span><br><span class="line">                <span class="comment">//初始访问url地址</span></span><br><span class="line">                .addUrl(<span class="string">"https://news.hao123.com/wangzhi"</span>)</span><br><span class="line">                .setScheduler(<span class="keyword">new</span> QueueScheduler()</span><br><span class="line">                        .setDuplicateRemover(<span class="keyword">new</span> BloomFilterDuplicateRemover(<span class="number">10000000</span>))) <span class="comment">//参数设置需要对多少条数据去重</span></span><br><span class="line">                .thread(<span class="number">5</span>)<span class="comment">//设置由五个线程处理</span></span><br><span class="line">                .run(); <span class="comment">// 执行爬虫</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"爬虫执行完成！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-三种去重方式"><a href="#3-2-三种去重方式" class="headerlink" title="3.2 三种去重方式"></a>3.2 三种去重方式</h4><h5 id="HashSet"><a href="#HashSet" class="headerlink" title="HashSet"></a>HashSet</h5><p>使用java中的HashSet不能重复的特点去重。</p>
<p>优点：容易理解。使用方便。</p>
<p>缺点：占用内存大，性能较低。</p>
<h5 id="Redis去重"><a href="#Redis去重" class="headerlink" title="Redis去重"></a>Redis去重</h5><p>使用Redis的set进行去重。</p>
<p>优点：速度快（Redis本身速度就很快），而且去重不会占用爬虫服务器的资源，可以处理更大数据量的数据爬取。</p>
<p>缺点：需要准备Redis服务器，增加开发和使用成本。</p>
<h5 id="布隆过滤器-使用较多"><a href="#布隆过滤器-使用较多" class="headerlink" title="布隆过滤器 (使用较多)"></a>布隆过滤器 (使用较多)</h5><p>使用布隆过滤器也可以实现去重。</p>
<h6 id="优缺点："><a href="#优缺点：" class="headerlink" title="优缺点："></a>优缺点：</h6><p>优点：占用的内存要比使用HashSet要小的多，也适合大量数据的去重操作。</p>
<p>缺点：有误判的可能。没有重复可能会判定重复，但是重复数据一定会判定重复。</p>
<h6 id="简介："><a href="#简介：" class="headerlink" title="简介："></a>简介：</h6><p><code>布隆过滤器 (Bloom Filter)是由Burton Howard Bloom于1970年提出</code>，它是一种space efficient的概率型数据结构，用于判断一个元素是否在集合中。<code>在垃圾邮件过滤的黑白名单方法、爬虫(Crawler)的网址判重模块中等等经常被用到。</code></p>
<p>哈希表也能用于判断元素是否在集合中，但是<code>布隆过滤器只需要哈希表的1/8或1/4的空间复杂度就能完成同样的问题</code>。布隆过滤器可以插入元素，但不可以删除已有元素。其中的元素越多，误报率越大，但是漏报是不可能的。</p>
<h6 id="原理："><a href="#原理：" class="headerlink" title="原理："></a>原理：</h6><p><a href="https://blog.csdn.net/tlk20071/article/details/78336407" target="_blank" rel="noopener">https://blog.csdn.net/tlk20071/article/details/78336407</a></p>
<h3 id="4-案例实现"><a href="#4-案例实现" class="headerlink" title="4. 案例实现"></a>4. 案例实现</h3><h4 id="4-1-开发准备"><a href="#4-1-开发准备" class="headerlink" title="4.1 开发准备"></a>4.1 开发准备</h4><p>创建Maven工程itbuild-crawler-job，并加入依赖。pom.xml为：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.itbuild<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itbuild-crawler-job<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringMVC--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--SpringData Jpa--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--MySQL连接包--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--WebMagic核心包--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>us.codecraft<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>webmagic-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.7.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--WebMagic扩展--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>us.codecraft<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>webmagic-extension<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.7.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--WebMagic对布隆过滤器的支持--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.guava<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>guava<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>16.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--工具包StringUtils--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-lang3<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果使用<code>webmagic0.7.4</code>报一下错误，解决办法：使用<code>webmagic0.7.3版本</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">java.lang.NoSuchFieldError: JAVA_11</span><br><span class="line">	at us.codecraft.webmagic.downloader.HttpClientGenerator.buildSSLConnectionSocketFactory(HttpClientGenerator.java:<span class="number">63</span>) ~[webmagic-core-<span class="number">0.7</span><span class="number">.4</span>.jar:na]</span><br><span class="line">	at us.codecraft.webmagic.downloader.HttpClientGenerator.&lt;init&gt;(HttpClientGenerator.java:<span class="number">53</span>) ~[webmagic-core-<span class="number">0.7</span><span class="number">.4</span>.jar:na]</span><br><span class="line">	at us.codecraft.webmagic.downloader.HttpClientDownloader.&lt;init&gt;(HttpClientDownloader.java:<span class="number">38</span>) ~[webmagic-core-<span class="number">0.7</span><span class="number">.4</span>.jar:na]</span><br><span class="line">	at us.codecraft.webmagic.Spider.initComponent(Spider.java:<span class="number">280</span>) ~[webmagic-core-<span class="number">0.7</span><span class="number">.4</span>.jar:na]</span><br><span class="line">	at us.codecraft.webmagic.Spider.run(Spider.java:<span class="number">305</span>) ~[webmagic-core-<span class="number">0.7</span><span class="number">.4</span>.jar:na]</span><br><span class="line">	at cn.itbuild.job.task.JobProcessor.processor(JobProcessor.java:<span class="number">51</span>) ~[classes/:na]</span><br><span class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:<span class="number">62</span>) ~[na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class="number">43</span>) ~[na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">	at java.lang.reflect.Method.invoke(Method.java:<span class="number">498</span>) ~[na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:<span class="number">65</span>) ~[spring-context-<span class="number">5.0</span><span class="number">.6</span>.RELEASE.jar:<span class="number">5.0</span><span class="number">.6</span>.RELEASE]</span><br><span class="line">	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:<span class="number">54</span>) ~[spring-context-<span class="number">5.0</span><span class="number">.6</span>.RELEASE.jar:<span class="number">5.0</span><span class="number">.6</span>.RELEASE]</span><br><span class="line">	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:<span class="number">511</span>) [na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">	at java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:<span class="number">308</span>) [na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java) [na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$<span class="number">301</span>(ScheduledThreadPoolExecutor.java:<span class="number">180</span>) [na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:<span class="number">294</span>) [na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:<span class="number">1149</span>) [na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:<span class="number">624</span>) [na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">	at java.lang.Thread.run(Thread.java:<span class="number">748</span>) [na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br></pre></td></tr></table></figure>

<h5 id="编写pojo"><a href="#编写pojo" class="headerlink" title="编写pojo"></a>编写pojo</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itbuild.job.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"></span><br><span class="line">/`</span><br><span class="line"> * <span class="meta">@Date</span> <span class="number">2020</span>/<span class="number">12</span>/<span class="number">30</span> <span class="number">11</span>:<span class="number">54</span></span><br><span class="line"> * <span class="meta">@Version</span> <span class="number">10.21</span></span><br><span class="line"> * <span class="meta">@Author</span> DuanChaojie</span><br><span class="line"> */</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JobInfo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String companyName;</span><br><span class="line">    <span class="keyword">private</span> String companyAddr;</span><br><span class="line">    <span class="keyword">private</span> String companyInfo;</span><br><span class="line">    <span class="keyword">private</span> String jobName;</span><br><span class="line">    <span class="keyword">private</span> String jobAddr;</span><br><span class="line">    <span class="keyword">private</span> String jobInfo;</span><br><span class="line">    <span class="keyword">private</span> Integer salaryMin;</span><br><span class="line">    <span class="keyword">private</span> Integer salaryMax;</span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> String time;</span><br><span class="line"></span><br><span class="line">    /`</span><br><span class="line">     * 生成 get/set 方法</span><br><span class="line">     */</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCompanyName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> companyName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCompanyName</span><span class="params">(String companyName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.companyName = companyName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCompanyAddr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> companyAddr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCompanyAddr</span><span class="params">(String companyAddr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.companyAddr = companyAddr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCompanyInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> companyInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCompanyInfo</span><span class="params">(String companyInfo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.companyInfo = companyInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getJobName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jobName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJobName</span><span class="params">(String jobName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.jobName = jobName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getJobAddr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jobAddr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJobAddr</span><span class="params">(String jobAddr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.jobAddr = jobAddr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getJobInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jobInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJobInfo</span><span class="params">(String jobInfo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.jobInfo = jobInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getSalaryMin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> salaryMin;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalaryMin</span><span class="params">(Integer salaryMin)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.salaryMin = salaryMin;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getSalaryMax</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> salaryMax;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalaryMax</span><span class="params">(Integer salaryMax)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.salaryMax = salaryMax;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUrl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUrl</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.url = url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> time;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTime</span><span class="params">(String time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.time = time;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /`</span><br><span class="line">     * 生成 toString() 方法</span><br><span class="line">     */</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"JobInfo&#123;"</span> +</span><br><span class="line">                <span class="string">"id="</span> + id +</span><br><span class="line">                <span class="string">", companyName='"</span> + companyName + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", companyAddr='"</span> + companyAddr + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", companyInfo='"</span> + companyInfo + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", jobName='"</span> + jobName + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", jobAddr='"</span> + jobAddr + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", jobInfo='"</span> + jobInfo + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", salaryMin="</span> + salaryMin +</span><br><span class="line">                <span class="string">", salaryMax="</span> + salaryMax +</span><br><span class="line">                <span class="string">", url='"</span> + url + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", time='"</span> + time + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="编写dao"><a href="#编写dao" class="headerlink" title="编写dao"></a>编写dao</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itbuild.job.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itbuild.job.pojo.JobInfo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"></span><br><span class="line">/`</span><br><span class="line"> * <span class="meta">@Date</span> <span class="number">2020</span>/<span class="number">12</span>/<span class="number">30</span> <span class="number">11</span>:<span class="number">57</span></span><br><span class="line"> * <span class="meta">@Version</span> <span class="number">10.21</span></span><br><span class="line"> * <span class="meta">@Author</span> DuanChaojie</span><br><span class="line"> */</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">JobInfoDao</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">JobInfo</span>,<span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="编写service"><a href="#编写service" class="headerlink" title="编写service"></a>编写service</h5><h6 id="JobInfoService"><a href="#JobInfoService" class="headerlink" title="JobInfoService"></a>JobInfoService</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itbuild.job.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itbuild.job.pojo.JobInfo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line">/`</span><br><span class="line"> * <span class="meta">@Date</span> <span class="number">2020</span>/<span class="number">12</span>/<span class="number">30</span> <span class="number">11</span>:<span class="number">58</span></span><br><span class="line"> * <span class="meta">@Version</span> <span class="number">10.21</span></span><br><span class="line"> * <span class="meta">@Author</span> DuanChaojie</span><br><span class="line"> */</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">JobInfoService</span> </span>&#123;</span><br><span class="line">    /`</span><br><span class="line">     * 保存工作信息</span><br><span class="line">     * <span class="meta">@param</span> jobInfo</span><br><span class="line">     */</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(JobInfo jobInfo)</span></span>;</span><br><span class="line"></span><br><span class="line">    /`</span><br><span class="line">     * 根据条件查询工作信息</span><br><span class="line">     * <span class="meta">@param</span> jobInfo</span><br><span class="line">     * <span class="meta">@return</span></span><br><span class="line">     */</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;JobInfo&gt; <span class="title">findJobInfo</span><span class="params">(JobInfo jobInfo)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="JobInfoServiceImpl"><a href="#JobInfoServiceImpl" class="headerlink" title="JobInfoServiceImpl"></a>JobInfoServiceImpl</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itbuild.job.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itbuild.job.dao.JobInfoDao;</span><br><span class="line"><span class="keyword">import</span> cn.itbuild.job.pojo.JobInfo;</span><br><span class="line"><span class="keyword">import</span> cn.itbuild.job.service.JobInfoService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line">/`</span><br><span class="line"> * <span class="meta">@Date</span> <span class="number">2020</span>/<span class="number">12</span>/<span class="number">30</span> <span class="number">11</span>:<span class="number">59</span></span><br><span class="line"> * <span class="meta">@Version</span> <span class="number">10.21</span></span><br><span class="line"> * <span class="meta">@Author</span> DuanChaojie</span><br><span class="line"> */</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JobInfoServiceImpl</span> <span class="keyword">implements</span> <span class="title">JobInfoService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JobInfoDao jobInfoDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(JobInfo jobInfo)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 根据每条工作信息的url和发布时间查询数据</span></span><br><span class="line">        JobInfo param = <span class="keyword">new</span> JobInfo();</span><br><span class="line">        param.setUrl(jobInfo.getUrl());</span><br><span class="line">        param.setTime(jobInfo.getTime());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行查询</span></span><br><span class="line">        List&lt;JobInfo&gt; list = <span class="keyword">this</span>.findJobInfo(param);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 判断查询结果是否为空</span></span><br><span class="line">        <span class="keyword">if</span> (list.size() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// 如果查询结果为空, 表示招聘信息数据不存在, 或者已经更新了, 需要增或者更新数据库</span></span><br><span class="line">            <span class="keyword">this</span>.jobInfoDao.saveAndFlush(jobInfo);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;JobInfo&gt; <span class="title">findJobInfo</span><span class="params">(JobInfo jobInfo)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 设置查询条件</span></span><br><span class="line">        Example example = Example.of(jobInfo);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行查询</span></span><br><span class="line">        List list = <span class="keyword">this</span>.jobInfoDao.findAll(example);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="编写启动类"><a href="#编写启动类" class="headerlink" title="编写启动类"></a>编写启动类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itbuild.job;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.EnableScheduling;</span><br><span class="line"></span><br><span class="line">/`</span><br><span class="line"> * <span class="meta">@Date</span> <span class="number">2020</span>/<span class="number">12</span>/<span class="number">30</span> <span class="number">12</span>:<span class="number">40</span></span><br><span class="line"> * <span class="meta">@Version</span> <span class="number">10.21</span></span><br><span class="line"> * <span class="meta">@Author</span> DuanChaojie</span><br><span class="line"> */</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableScheduling</span><span class="comment">// 开启定时任务</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JobApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(JobApplication<span class="class">.<span class="keyword">class</span>,<span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-代码实现"><a href="#4-2-代码实现" class="headerlink" title="4.2 代码实现"></a>4.2 代码实现</h4><h5 id="工具类MathSalary"><a href="#工具类MathSalary" class="headerlink" title="工具类MathSalary"></a>工具类MathSalary</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itbuild.job.utils;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换薪资</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MathSalary</span> </span>&#123;</span><br><span class="line">    /`</span><br><span class="line">     * 获取薪水范围</span><br><span class="line">     * <span class="meta">@param</span> salaryStr</span><br><span class="line">     * <span class="meta">@return</span></span><br><span class="line">     */</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Integer[] getSalary(String salaryStr) &#123;</span><br><span class="line">        <span class="comment">//声明存放薪水范围的数组</span></span><br><span class="line">        Integer[] salary = <span class="keyword">new</span> Integer[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">//"500/天"</span></span><br><span class="line">        <span class="comment">//0.8-1.2万/月</span></span><br><span class="line">        <span class="comment">//5-8千/月</span></span><br><span class="line">        <span class="comment">//5-6万/年</span></span><br><span class="line">        String date = salaryStr.substring(salaryStr.length() - <span class="number">1</span>, salaryStr.length());</span><br><span class="line">        <span class="comment">//如果是按天，则直接乘以240进行计算</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="string">"月"</span>.equals(date) &amp;&amp; !<span class="string">"年"</span>.equals(date)) &#123;</span><br><span class="line">            salaryStr = salaryStr.substring(<span class="number">0</span>, salaryStr.length() - <span class="number">2</span>);</span><br><span class="line">            salary[<span class="number">0</span>] = salary[<span class="number">1</span>] = str2Num(salaryStr, <span class="number">240</span>);</span><br><span class="line">            <span class="keyword">return</span> salary;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String unit = salaryStr.substring(salaryStr.length() - <span class="number">3</span>, salaryStr.length() - <span class="number">2</span>);</span><br><span class="line">        String[] salarys = salaryStr.substring(<span class="number">0</span>, salaryStr.length() - <span class="number">3</span>).split(<span class="string">"-"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        salary[<span class="number">0</span>] = mathSalary(date, unit, salarys[<span class="number">0</span>]);</span><br><span class="line">        salary[<span class="number">1</span>] = mathSalary(date, unit, salarys[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> salary;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据条件计算薪水</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Integer <span class="title">mathSalary</span><span class="params">(String date, String unit, String salaryStr)</span> </span>&#123;</span><br><span class="line">        Integer salary = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断单位是否是万</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"万"</span>.equals(unit)) &#123;</span><br><span class="line">            <span class="comment">//如果是万，薪水乘以10000</span></span><br><span class="line">            salary = str2Num(salaryStr, <span class="number">10000</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//否则乘以1000</span></span><br><span class="line">            salary = str2Num(salaryStr, <span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断时间是否是月</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"月"</span>.equals(date)) &#123;</span><br><span class="line">            <span class="comment">//如果是月，薪水乘以12</span></span><br><span class="line">            salary = str2Num(salary.toString(), <span class="number">12</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> salary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">str2Num</span><span class="params">(String salaryStr, <span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 把字符串转为小数，必须用Number接受，否则会有精度丢失的问题</span></span><br><span class="line">            Number result = Float.parseFloat(salaryStr) * num;</span><br><span class="line">            <span class="keyword">return</span> result.intValue();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="自定义Pipeline存储数据"><a href="#自定义Pipeline存储数据" class="headerlink" title="自定义Pipeline存储数据"></a>自定义Pipeline存储数据</h5><p>在WebMagic中，Pileline是抽取结束后，进行处理的部分，它主要用于抽取结果的保存，也可以定制Pileline可以实现一些通用的功能。在这里我们会定制Pipeline实现数据导入到数据库中。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itbuild.job.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itbuild.job.pojo.JobInfo;</span><br><span class="line"><span class="keyword">import</span> cn.itbuild.job.service.JobInfoService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.ResultItems;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Task;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.pipeline.Pipeline;</span><br><span class="line"></span><br><span class="line">/`</span><br><span class="line"> * <span class="meta">@Date</span> <span class="number">2020</span>/<span class="number">12</span>/<span class="number">30</span> <span class="number">15</span>:<span class="number">20</span></span><br><span class="line"> * <span class="meta">@Version</span> <span class="number">10.21</span></span><br><span class="line"> * <span class="meta">@Author</span> DuanChaojie</span><br><span class="line"> */</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringDataPipeline</span> <span class="keyword">implements</span> <span class="title">Pipeline</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JobInfoService jobInfoService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(ResultItems resultItems, Task task)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 获取封装好的招聘详情对象</span></span><br><span class="line">        JobInfo jobInfo = resultItems.get(<span class="string">"jobInfo"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 判断是否不为空</span></span><br><span class="line">        <span class="keyword">if</span> (jobInfo != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 如果不为空把数据保存到数据库中</span></span><br><span class="line">            <span class="keyword">this</span>.jobInfoService.save(jobInfo);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="编写主要的爬虫task"><a href="#编写主要的爬虫task" class="headerlink" title="编写主要的爬虫task"></a>编写主要的爬虫task</h5><p>稍微自己修改了一下, 因为 51job 现在的网页和之前相比改了一些, 数据不能直接在网页的元素上拿到, 所以解析数据的方式也得有所变化, 只能想办法解析网页中的js代码, 测试基本没有什么问题。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itbuild.job.task;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itbuild.job.pojo.JobInfo;</span><br><span class="line"><span class="keyword">import</span> cn.itbuild.job.utils.MathSalary;</span><br><span class="line"><span class="keyword">import</span> cn.itbuild.job.utils.SpringDataPipeline;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONArray;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.jsoup.Jsoup;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Page;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Site;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Spider;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.processor.PageProcessor;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.scheduler.BloomFilterDuplicateRemover;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.scheduler.QueueScheduler;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.selector.Html;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line">/`</span><br><span class="line"> * <span class="meta">@Date</span> <span class="number">2020</span>/<span class="number">12</span>/<span class="number">30</span> <span class="number">12</span>:<span class="number">49</span></span><br><span class="line"> * <span class="meta">@Version</span> <span class="number">10.21</span></span><br><span class="line"> * <span class="meta">@Author</span> DuanChaojie</span><br><span class="line"> */</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JobProcessor</span> <span class="keyword">implements</span> <span class="title">PageProcessor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String url = <span class="string">"https://search.51job.com/list/070200,000000,0000,00,9,99,java,2,1.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare="</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> SimpleDateFormat formatter = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-"</span>);</span><br><span class="line">    <span class="keyword">private</span> String today = formatter.format(<span class="keyword">new</span> Date());</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(Page page)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 解析页面，获取招聘信息的url地址</span></span><br><span class="line">        <span class="comment">//List&lt;Selectable&gt; list = page.getHtml().css("div.j_joblist div.e").nodes();</span></span><br><span class="line">        <span class="comment">// 因为在51招聘的页面中不能直接拿到页面元素, 经分析数据在页面的js中</span></span><br><span class="line">        <span class="comment">// 于是想办法将js对象(json数据)解析出来, 获取到详情页面的链接放到任务队列中</span></span><br><span class="line">        <span class="comment">// 解析页面, 获取script中招聘详情信息</span></span><br><span class="line">        String dataJs = page.getHtml().css(<span class="string">"script"</span>).regex(<span class="string">".*SEARCH_RESULT.*"</span>).get();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 判断获取到的页面是否为空</span></span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(dataJs))&#123;</span><br><span class="line">            System.out.println(<span class="string">"-----------开始抓取第"</span> + count++ + <span class="string">"页----------"</span>);</span><br><span class="line">            <span class="comment">// 如果不为空, 表示这是列表页</span></span><br><span class="line">            <span class="comment">// 解析拿到json字符串</span></span><br><span class="line">            dataJs = dataJs.substring(dataJs.indexOf(<span class="string">"&#123;"</span>), dataJs.lastIndexOf(<span class="string">"&#125;"</span>) + <span class="number">1</span>);</span><br><span class="line">            <span class="comment">// 创建json对象</span></span><br><span class="line">            JSONObject jsonObject = (JSONObject) JSONObject.parse(dataJs);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 根据分析拿到放置信息的数组</span></span><br><span class="line">            JSONArray resArr = jsonObject.getJSONArray(<span class="string">"engine_search_result"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 判断数组中是否存在数据</span></span><br><span class="line">            <span class="keyword">if</span> (resArr.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; resArr.size(); i++) &#123;</span><br><span class="line">                    <span class="comment">// 获取数组中的每一个对象</span></span><br><span class="line">                    JSONObject resObj = (JSONObject) resArr.get(i);</span><br><span class="line">                    <span class="comment">//把获取到的url地址放到任务队列中</span></span><br><span class="line">                    page.addTargetRequest(String.valueOf(resObj.get(<span class="string">"job_href"</span>)));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 获取下一页的url</span></span><br><span class="line">                String bkUrl = <span class="string">"https://search.51job.com/list/070200,000000,0000,00,9,99,java,2,"</span>+(count++)+<span class="string">".html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare="</span>;</span><br><span class="line">                <span class="comment">// 把url放到任务队列中</span></span><br><span class="line">                page.addTargetRequest(bkUrl);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 设置变量为初始值</span></span><br><span class="line">                count = <span class="number">0</span>;</span><br><span class="line">                <span class="comment">// 如果没有数据那么爬虫结束</span></span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 如果为空, 表示这是招聘详情页, 解析页面, 获取招聘详情信息, 保存数据</span></span><br><span class="line">            <span class="keyword">this</span>.saveJobInfo(page);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /`</span><br><span class="line">     *  解析页面, 获取招聘详情信息, 保存数据</span><br><span class="line">     * <span class="meta">@param</span> page</span><br><span class="line">     */</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">saveJobInfo</span><span class="params">(Page page)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 创建招聘详情对象</span></span><br><span class="line">        JobInfo jobInfo = <span class="keyword">new</span> JobInfo();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解析页面</span></span><br><span class="line">        Html html = page.getHtml();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取数据, 封装到对象中</span></span><br><span class="line">        <span class="comment">// 拿到有地址和发布时间的那条文字</span></span><br><span class="line">        String desc = Jsoup.parse(html.css(<span class="string">"p.msg.ltype"</span>).toString()).text();</span><br><span class="line">        <span class="keyword">if</span> (desc == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 有极少数非51内部网站无法找到</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 为了能够找到发布时间截取了字符串</span></span><br><span class="line">        desc = desc.substring(<span class="number">0</span>, desc.lastIndexOf(<span class="string">"发布"</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置职位名称</span></span><br><span class="line">        jobInfo.setJobName(html.css(<span class="string">"div.cn h1"</span>, <span class="string">"text"</span>).toString());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置公司名称</span></span><br><span class="line">        jobInfo.setCompanyName(html.css(<span class="string">"div.cn p.cname a"</span>, <span class="string">"text"</span>).toString().trim());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置公司地址</span></span><br><span class="line">        jobInfo.setCompanyAddr(desc.substring(<span class="number">0</span>, desc.indexOf(<span class="string">"|"</span>)).trim());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置公司信息</span></span><br><span class="line">        jobInfo.setCompanyInfo(Jsoup.parse(html.css(<span class="string">"div.tmsg.inbox"</span>).toString()).text());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置工作地址</span></span><br><span class="line">        jobInfo.setJobAddr(html.css(<span class="string">"div.bmsg&gt;p.fp"</span>, <span class="string">"text"</span>).toString());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置工作信息(要求)</span></span><br><span class="line">        jobInfo.setJobInfo(Jsoup.parse(html.css(<span class="string">"div.job_msg"</span>).toString()).text());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置当前链接</span></span><br><span class="line">        jobInfo.setUrl(page.getUrl().toString());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取薪资</span></span><br><span class="line">        <span class="comment">// 有的没有写薪资, 先获取薪资的字符串</span></span><br><span class="line">        String salaryText = html.css(<span class="string">"div.cn strong"</span>, <span class="string">"text"</span>).toString();</span><br><span class="line">        <span class="comment">// 看看是否没有薪资这个字段</span></span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(salaryText)) &#123;</span><br><span class="line">            <span class="comment">// 使用工具类转换薪资字符串</span></span><br><span class="line">            Integer[] salary = MathSalary.getSalary(salaryText);</span><br><span class="line">            jobInfo.setSalaryMin(salary[<span class="number">0</span>]);</span><br><span class="line">            jobInfo.setSalaryMax(salary[<span class="number">1</span>]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 没有则设为零</span></span><br><span class="line">            jobInfo.setSalaryMax(<span class="number">0</span>);</span><br><span class="line">            jobInfo.setSalaryMin(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取发布时间</span></span><br><span class="line">        String time = desc.substring(desc.lastIndexOf(<span class="string">"|"</span>) + <span class="number">3</span>);</span><br><span class="line">        jobInfo.setTime(today + time.trim());</span><br><span class="line">        <span class="comment">// 把结果保存起来</span></span><br><span class="line">        page.putField(<span class="string">"jobInfo"</span>, jobInfo);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Site site = Site.me()</span><br><span class="line">            .setCharset(<span class="string">"gbk"</span>) <span class="comment">// 设置编码</span></span><br><span class="line">            .setTimeOut(<span class="number">10</span>*<span class="number">1000</span>) <span class="comment">// 设置超时时间</span></span><br><span class="line">            .setRetrySleepTime(<span class="number">3000</span>) <span class="comment">// 设置重试的间隔时间</span></span><br><span class="line">            .setRetryTimes(<span class="number">3</span>); <span class="comment">// 设置重试的次数</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Site <span class="title">getSite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> site;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SpringDataPipeline springDataPipeline;</span><br><span class="line">    </span><br><span class="line">    /`</span><br><span class="line">     * initialDelay当任务启动后, 等多久执行方法</span><br><span class="line">     * fixedDelay每隔多久执行方法</span><br><span class="line">     */</span><br><span class="line">    <span class="meta">@Scheduled</span>(initialDelay = <span class="number">1000</span>,fixedDelay = <span class="number">10</span>*<span class="number">1000</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">processor</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Spider.create(<span class="keyword">new</span> JobProcessor())</span><br><span class="line">                .addUrl(url)</span><br><span class="line">                .setScheduler(<span class="keyword">new</span> QueueScheduler()</span><br><span class="line">                        <span class="comment">// 使用布隆过滤器</span></span><br><span class="line">                        .setDuplicateRemover(<span class="keyword">new</span> BloomFilterDuplicateRemover(<span class="number">10</span>*<span class="number">1000</span>)))</span><br><span class="line">                .thread(<span class="number">10</span>)</span><br><span class="line">                <span class="comment">// 设置自定义的Pipeline储存数据</span></span><br><span class="line">                .addPipeline(<span class="keyword">this</span>.springDataPipeline)</span><br><span class="line">                .run();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"-----------"</span>);</span><br><span class="line">        System.out.println(<span class="string">"爬取数据完成！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://oss-blogs.oss-cn-hangzhou.aliyuncs.com/blogs/itbuild/JavaSE-%E7%88%AC%E8%99%AB/image-20201230162912769.png" alt="image-20201230162912769"></p>
<h3 id="5-案例扩展"><a href="#5-案例扩展" class="headerlink" title="5. 案例扩展"></a>5. 案例扩展</h3><h4 id="5-1-定时任务"><a href="#5-1-定时任务" class="headerlink" title="5.1 定时任务"></a>5.1 定时任务</h4><p>在案例中我们使用的是Spring内置的Spring Task，这是Spring3.0加入的定时任务功能。我们使用注解的方式定时启动爬虫进行数据爬取。</p>
<p>我们使用的是<code>@Scheduled注解</code>，其属性如下：</p>
<ol>
<li><code>cron：</code>cron表达式，指定任务在特定时间执行；</li>
<li><code>fixedDelay</code>：上一次任务执行完后多久再执行，参数类型为long，单位ms</li>
<li><code>fixedDelayString：</code>与fixedDelay含义一样，只是参数类型变为String</li>
<li><code>fixedRate：</code>按一定的频率执行任务，参数类型为long，单位ms</li>
<li><code>fixedRateString:</code> 与fixedRate的含义一样，只是将参数类型变为String</li>
<li><code>initialDelay：</code>延迟多久再第一次执行任务，参数类型为long，单位ms</li>
<li><code>initialDelayString：</code>与initialDelay的含义一样，只是将参数类型变为String</li>
<li><code>zone：</code>时区，默认为当前时区，一般没有用到。</li>
</ol>
<p>我们这里的使用比较简单，固定的间隔时间来启动爬虫。例如可以实现项目启动后，每隔一小时启动一次爬虫。</p>
<p>但是有可能业务要求更高，并不是定时定期处理，而是在特定的时间进行处理，这个时候我们之前的使用方式就不能满足需求了。例如我要在工作日（周一到周五）的晚上八点执行。这时我们就需要Cron表达式了。</p>
<h5 id="Cron表达式"><a href="#Cron表达式" class="headerlink" title="Cron表达式"></a>Cron表达式</h5><p>cron的表达式是字符串，实际上是由七子表达式，描述个别细节的时间表。这些子表达式是分开的空白，代</p>
<ol>
<li><code>Seconds</code></li>
<li><code>Minutes</code></li>
<li><code>Hours</code></li>
<li><code>Day-of-Month</code></li>
<li><code>Month</code></li>
<li><code>Day-of-Week</code></li>
<li><code>Year (可选字段)</code></li>
</ol>
<p>例 <code>&quot;0 0 12 ? * WED&quot;</code> 在每星期三下午12:00 执行,<code>“*”</code> 代表整个时间段。</p>
<p>每一个字段都有一套可以指定有效值，如</p>
<ol>
<li>Seconds (秒) ：可以用数字0－59 表示，</li>
<li>Minutes(分) ：可以用数字0－59 表示，</li>
<li>Hours(时) ：可以用数字0-23表示,</li>
<li>Day-of-Month(天) ：可以用数字1-31 中的任一一个值，但要注意一些特别的月份</li>
<li>Month(月) ：可以用0-11 或用字符串：JAN, FEB, MAR, APR, MAY, JUN, JUL, AUG, SEP, OCT, NOV, DEC</li>
<li>Day-of-Week(天) ：可以用数字1-7表示（1 ＝ 星期日）或用字符口串：SUN, MON, TUE, WED, THU, FRI, SAT</li>
</ol>
<p><code>“/”：</code>为特别单位，表示为“每”如“0/15”表示每隔15分钟执行一次,“0”表示为从“0”分开始, “3/20”表示表示每隔20分钟执行一次，“3”表示从第3分钟开始执行。</p>
<p><code>“?”：</code>表示每月的某一天，或第周的某一天</p>
<p><code>“L”：</code>用于每月，或每周，表示为每月的最后一天，或每个月的最后星期几如“6L”表示“每月的最后一个星期五”</p>
<p>在线Cron表达式生成器：<a href="https://cron.qqe2.com/" target="_blank" rel="noopener">https://cron.qqe2.com/</a></p>
<h5 id="Cron测试"><a href="#Cron测试" class="headerlink" title="Cron测试"></a>Cron测试</h5><p>先把之前爬虫的@Component注解取消，避免干扰测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JobProcessor</span> <span class="keyword">implements</span> <span class="title">PageProcessor</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>编写使用Cron表达式的测试用例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itbuild.job.task;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaskTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Scheduled</span>(cron = <span class="string">"0/5 * * * * *"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"定时任务执行了"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-2-网页去重"><a href="#5-2-网页去重" class="headerlink" title="5.2 网页去重"></a>5.2 网页去重</h4><p>之前我们对下载的url地址进行了去重操作，避免同样的url下载多次。其实不光url需要去重，我们对下载的内容也需要去重。</p>
<p>在网上我们可以找到许多内容相似的文章。但是实际我们只需要其中一个即可，同样的内容没有必要下载多次，那么如何进行去重就需要进行处理了</p>
<h5 id="去重方案介绍"><a href="#去重方案介绍" class="headerlink" title="去重方案介绍"></a>去重方案介绍</h5><h6 id="指纹码对比"><a href="#指纹码对比" class="headerlink" title="指纹码对比"></a>指纹码对比</h6><p>最常见的去重方案是生成文档的指纹门。例如对一篇文章进行MD5加密生成一个字符串，我们可以认为这是文章的指纹码，再和其他的文章指纹码对比，一致则说明文章重复。</p>
<p>但是这种方式是完全一致则是重复的，如果文章只是多了几个标点符号，那仍旧被认为是重复的，这种方式并不合理。</p>
<h6 id="BloomFilter"><a href="#BloomFilter" class="headerlink" title="BloomFilter"></a>BloomFilter</h6><p>这种方式就是我们之前对url进行去重的方式，使用在这里的话，也是对文章进行计算得到一个数，再进行对比，缺点和方法1是一样的，如果只有一点点不一样，也会认为不重复，这种方式不合理。</p>
<h6 id="KMP算法"><a href="#KMP算法" class="headerlink" title="KMP算法"></a>KMP算法</h6><p><a href="https://blog.csdn.net/weixin_45267102/article/details/109003586" target="_blank" rel="noopener">KMP算法</a>是一种改进的字符串匹配算法。KMP算法的关键是利用匹配失败后的信息，尽量减少模式串与主串的匹配次数以达到快速匹配的目的。能够找到两个文章有哪些是一样的，哪些不一样。</p>
<p>这种方式能够解决前面两个方式的“只要一点不一样就是不重复”的问题。但是它的空间复杂度太高了，不适合大数据量的重复比对。</p>
<h6 id="SimHash"><a href="#SimHash" class="headerlink" title="SimHash"></a>SimHash</h6><p>还有一些其他的去重方式：<code>最长公共子串、后缀数组、字典树、DFA等等，但是这些方式的空复杂度并不适合数据量较大的工业应用场景。</code>我们需要找到一款性能高速度快，能够进行相似度对比的去重方案</p>
<p>Google 的 simhash 算法产生的签名，可以满足上述要求。这个算法并不深奥，比较容易理解。这种算法也是目前Google搜索引擎所目前所使用的网页去重算法。</p>
<p><a href="https://blog.csdn.net/lengye7/article/details/79789206" target="_blank" rel="noopener">simhash算法及原理简介</a></p>
<h4 id="5-3-代理的使用"><a href="#5-3-代理的使用" class="headerlink" title="5.3 代理的使用"></a>5.3 代理的使用</h4><p>有些网站不允许爬虫进行数据爬取，因为会加大服务器的压力。其中一种最有效的方式是通过ip+时间进行鉴别，因为正常人不可能短时间开启太多的页面，发起太多的请求。</p>
<p>我们使用的WebMagic可以很方便的设置爬取数据的时间, 但是这样会大大降低我们爬取数据的效率，如果不小心ip被禁了，会让我们无法爬去数据，那么我们就有必要使用代理服务器来爬取数据。</p>
<h5 id="代理服务器"><a href="#代理服务器" class="headerlink" title="代理服务器"></a>代理服务器</h5><p><code>代理（英语：Proxy）</code>，也称网络代理，是一种特殊的网络服务，允许一个网络终端（一般为客户端）通过这个服务与另一个网络终端（一般为服务器）进行非直接的连接。</p>
<p><code>提供代理服务的电脑系统或其它类型的网络终端称为代理服务器（英文：Proxy Server）</code>。一个完整的代理请求过程为：客户端首先与代理服务器创建连接，接着根据代理服务器所使用的代理协议，请求对目标服务器创建连接、或者获得目标服务器的指定资源。</p>
<p>我们就需要知道代理服务器在哪里（ip和端口号）才可以使用。网上有很多代理服务器的提供商，但是大多是免费的不好用，付费的还行。</p>
<p>提供免费代理ip的服务商网站：</p>
<p>米扑代理：<a href="https://proxy.mimvp.com/free.php" target="_blank" rel="noopener">https://proxy.mimvp.com/free.php</a></p>
<h5 id="使用代理"><a href="#使用代理" class="headerlink" title="使用代理"></a>使用代理</h5><p>WebMagic使用的代理APIProxyProvider。因为相对于Site的“配置”，ProxyProvider定位更多是一个“组件”，所以代理不再从Site设置，而是由HttpClientDownloader设置。</p>
<table>
<thead>
<tr>
<th>API</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>HttpClientDownloader.setProxyProvider(ProxyProvider proxyProvider)</code></td>
<td>设置代理</td>
</tr>
</tbody></table>
<p>ProxyProvider有一个默认实现：SimpleProxyProvider。它是一个基于简单Round-Robin的、没有失败检查的ProxyProvider。可以配置任意个候选代理，每次会按顺序挑选一个代理使用。它适合用在自己搭建的比较稳定的代理的场景。</p>
<p>如果需要根据实际使用情况对代理服务器进行管理（例如校验是否可用，定期清理、添加代理服务器等），只需要自己实现APIProxyProvider即可。</p>
<p>请求能返回地址的api： <a href="https://api.myip.com/" target="_blank" rel="noopener">https://api.myip.com/</a> </p>
<p>为了避免干扰，先把之前项目中的其他任务的@Component注释掉，再在案例中加入编写以下逻辑：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itbuild.job.task;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Page;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Site;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Spider;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.downloader.HttpClientDownloader;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.processor.PageProcessor;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.proxy.Proxy;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.proxy.SimpleProxyProvider;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyTest</span> <span class="keyword">implements</span> <span class="title">PageProcessor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Scheduled</span>(fixedDelay = <span class="number">1000</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 创建下载器 Downloader</span></span><br><span class="line">        HttpClientDownloader httpClientDownloader = <span class="keyword">new</span> HttpClientDownloader();</span><br><span class="line">        <span class="comment">// 给下载器设置代理服务器信息</span></span><br><span class="line">        httpClientDownloader.setProxyProvider(SimpleProxyProvider.from(<span class="keyword">new</span> Proxy(<span class="string">"221.122.91.75"</span>, <span class="number">10286</span>)));</span><br><span class="line">        Spider.create(<span class="keyword">new</span> ProxyTest())</span><br><span class="line">                .addUrl(<span class="string">"https://api.myip.com/"</span>)</span><br><span class="line">                .setDownloader(httpClientDownloader)<span class="comment">// 设置下载器</span></span><br><span class="line">                .run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(Page page)</span> </span>&#123;</span><br><span class="line">        System.out.println(page.getHtml().toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Site site = Site.me();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Site <span class="title">getSite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> site;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="☆"><a href="#☆" class="headerlink" title="☆"></a>☆</h2></div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">DuanChaojie</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="http://www.itbuild.cn/2020/12/30/JavaSE-%E7%88%AC%E8%99%AB/%E3%80%90Java%E7%88%AC%E8%99%AB%E3%80%91%E2%80%94%E7%88%AC%E5%8F%9651job%E7%BD%91Java%E6%8B%9B%E8%81%98%E4%BF%A1%E6%81%AF/">http://www.itbuild.cn/2020/12/30/JavaSE-%E7%88%AC%E8%99%AB/%E3%80%90Java%E7%88%AC%E8%99%AB%E3%80%91%E2%80%94%E7%88%AC%E5%8F%9651job%E7%BD%91Java%E6%8B%9B%E8%81%98%E4%BF%A1%E6%81%AF/</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.itbuild.cn">it❤ld</a>！</span></div></div></article><div id="pagination"><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2020/12/30/JavaSE-%E7%88%AC%E8%99%AB/%E3%80%90Java%E7%88%AC%E8%99%AB%E3%80%91%E2%80%94%E4%BA%AC%E4%B8%9C%E6%89%8B%E6%9C%BA%E4%BF%A1%E6%81%AF%E7%88%AC%E5%8F%96%E6%A1%88%E4%BE%8B/"><span>JavaSE-爬虫/【Java爬虫】—京东手机信息爬取案例</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2020 ～ 2021 By DuanChaojie</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--></body></html>